<div class="reports-con">
  <div class="top-container sms_container">
    <div class="col-md-10 top-links" ng-include="'templates/sms/top-bar.html'">
    </div>
    <div class="col-md-2 side_filter">
      <button style="margin-top: 10px; float: right;" ng-click="downloadLogs(pagingData)">{{'button.download' | translate:translationData}}</button>
    </div>
  </div>
  <div class="sms_filter">
    <div class="row">
      <div class="col-md-12">
        <div class="col-md-10">
          <div class="side_filter">
            <label>{{'sms.Date_From' | translate:translationData}}</label>
            <div class="text_box">
              <input type="text" class="form-control" placeholder="YYYY-MM-DD" uib-datepicker-popup="{{format}}" is-open="from.open" min-date="minDate" max-date="pagingData.fromFilter" datepicker-options="dateOptions" ng-click="openFrom($event)" ng-model="pagingData.fromFilter" show-button-bar="false">
            </div>

            <label>{{'sms.Date_To' | translate:translationData}}</label>
            <div class="text_box">
              <input type="text" class="form-control" placeholder="YYYY-MM-DD" uib-datepicker-popup="{{format}}" is-open="to.open" min-date="pagingData.toFilter" datepicker-options="dateOptions" ng-click="openTo($event)" ng-model="pagingData.toFilter" show-button-bar="false">
            </div>
            <label>{{'Users' | translate:translationData}}</label>
            <div class="text_box">
              <select class="form-control" style="margin-top: 7px;" ng-model="pagingData.user_id" ng-options="item.id as item.full_name for item in allUsers" ng-change="filterLogs(pagingData)">
                <option value="">--Select Sender--</option>>
              </select>
            </div>

           <!--  <div class="form-group">
              <label>{{'appointment.businesses' | translate:translationData}}</label>
              <div class="arr_con">
                <div class="btn-group" uib-dropdown is-open="status.isopen">
                  <button id="busines_filter" type="button" class="btn btn-primary" uib-dropdown-toggle ng-disabled="disabled">
                    {{'appointment.businesses' | translate:translationData}} 
                  </button>
                  <ul class="dropdown-menu" uib-dropdown-menu role="menu" aria-labelledby="busines_filter" ng-click="stopEvent($event)">
                    <li role="menuitem" ng-repeat="buss in appFilter.businesses">
                      <label>
                        <input type="checkbox" ng-model="buss.ischecked"><span></span> {{buss.name}}
                      </label>
                    </li>
                  </ul>
                </div>
              </div>
            </div> -->
            <button ng-click="filterLogs(pagingData)">{{'button.Apply' | translate:translationData}}</button>
            <button ng-click="clearLogs(pagingData)">{{'button.Clear' | translate:translationData}}</button>
          </div>
        </div>
        <div class="col-md-2">
          <div class="filter_btns">
            <span ng-if="logs.length != 0">{{'sms.Total_eq' | translate:translationData}} {{logs.total}} {{logs.length < 1 ? 'log' : 'Logs'}}</span>
          </div>
        </div>
      </div>
    </div>
    <div class="clearfix"></div>
  </div> 

  <div class="sms_con" ng-scrollbars rebuild-on-resize rebuild-on="rebuild:me">
    <div class="table-responsive reports-table">
      <table class="table table-hover">
        <thead>
          <tr>
            <th>{{'sms.Customer_Name' | translate:translationData}}</th>
            <th>{{'sms.Sender_Name' | translate:translationData}}</th>
            <th>{{'sms.Contact_Number' | translate:translationData}}</th>
            <th>{{'settings.user_practitioners.label_type' | translate:translationData}}</th>
            <th>{{'sms.Delivered_On' | translate:translationData}}</th>
            <th>{{'settings.data_import.table_heading_status' | translate:translationData}}</th>
            <th class="text-center">{{'sms.Action' | translate:translationData}}</th>
          </tr>  
        </thead>
        <tbody>
          <tr ng-if="logs.length == 0">
            <td colspan="7" class="text-center">{{'sms.No_Logs_Found' | translate:translationData}}</td>
          </tr>
          <tr ng-repeat="log in logs.logs" ng-class="{'active' : log.isSelect}">
            <td><h4>{{log.sender_name}}<span ng-if="log.concession != null">({{log.concession}})</span></h4></td>
            <td>
              <h4 ng-if="log.current_user_msg_sender!=null">{{log.current_user_msg_sender}}</h4>
              <h4 ng-if="log.current_user_msg_sender==null">N/A</h4>
            </td>
            <td>{{log.to}}</td>
            <td>{{log.sms_type}}</td>
            <td>{{log.delivered_on | date : 'dd-MM-yyyy HH:mm:ss'}}</td>
            <td>
              <span ng-class="{'delivered' : log.status == 'Delivered' || log.status == 'Received', 'notSent' : log.status != 'Delivered' && log.status != 'Received'}">{{log.status}}</span>
            </td>
            <td class="text-center">
              <a href="" ui-sref="smsLogs.Contactview({'contactType' : log.sender_id})" ng-if="log.sender_type == 'Contact'"><i class="fa fa-eye fa-2x"></i></a>
              <a href="" ui-sref="smsLogs.Patientview({'patientType' : log.sender_id})" ng-if="log.sender_type == 'Patient'"><i class="fa fa-eye fa-2x"></i></a>
              <a href="" ui-sref="smsLogs.unknownview({'unknownNo' : log.from})" ng-if="log.sender_name == 'Unknown'"><i class="fa fa-eye fa-2x"></i></a>
              <a href="" ui-sref="smsLogs.Userview({'userType' : log.sender_id})" ng-if="log.sender_type == 'User'"><i class="fa fa-eye fa-2x"></i></a>
            </td>
          </tr>
        </tbody>
      </table>
    </div>

    <div class="" ng-if="pagingData.TotalItems > 30">
      <div class="row" ng-controller="PagePaginationController" ng-show="showGrid">
        <div class="col-lg-12 col-sm-12 col-md-12">
          <div class="col-lg-12 side_filter">
            <label style="border-right: none;">Page Size&nbsp;&nbsp;
            <select ng-model="pager.pageSize" ng-options="pageNo for pageNo in pager.pageSizeValues" ng-change="onSelectPageSize(pagingData, pager.pageSize)" class="paging-select" ng-disabled="pager.currentPage == pager.numPages"></select>
            </label>
          </div>
          <div class="col-lg-10 col-sm-10 col-md-10">
              <pagination total-items="pager.totalItems" ng-model="pager.currentPage" max-size="pager.maxSize" items-per-page="pager.pageSize" class="pagination-sm" boundary-links="true" rotate="false" num-pages="pager.numPages" ng-change="onSelectPage(pagingData, pager.currentPage)">
              </pagination>
          </div>
      <!--<label id="lblPagingInfo" class="pager-info" ng-cloak class="ng-cloak">
            Page: {{pager.currentPage}} / {{pager.numPages}} Total Items: {{pager.totalItems}}
          </label> -->
          <div ng-init="initPager(pagingData);"></div>
        </div>
      </div>
    </div>

  </div>

</div>

<div ui-view></div>