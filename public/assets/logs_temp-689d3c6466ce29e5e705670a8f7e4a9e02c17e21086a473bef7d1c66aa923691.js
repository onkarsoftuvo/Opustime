var adminApp=angular.module("adminApplication",["ui.bootstrap","bw.paging"]);adminApp.controller("logsCtrl",["$scope","$rootScope","$http","$filter","$uibModal",function($scope,$rootScope,$http,$filter,$uibModal){function addZero(data){return data<10?"0"+data:data}$scope.firstTab=!0,$scope.secondTab=!1,$scope.thirdTab=!1,$scope.fourthTab=!1,$scope.loading=!1,$scope.openFirst=function(){$scope.firstTab=!0,$scope.secondTab=!1,$scope.thirdTab=!1,$scope.fourthTab=!1},$scope.openSecond=function(){$scope.firstTab=!1,$scope.secondTab=!0,$scope.thirdTab=!1,$scope.fourthTab=!1,$scope.allQbLogs($scope.currentQBPage,$scope.qbNoOfPage,$scope.qbBusiness,$scope.qbfilter.start,$scope.qbfilter.end)},$scope.openThird=function(){$scope.firstTab=!1,$scope.secondTab=!1,$scope.thirdTab=!0,$scope.fourthTab=!1,$scope.allAULogs($scope.currentAUPage,$scope.auNoOfPage,$scope.auBusiness,$scope.aufilter.start,$scope.aufilter.end)},$scope.openFourth=function(){$scope.firstTab=!1,$scope.secondTab=!1,$scope.thirdTab=!1,$scope.fourthTab=!0,$scope.allADLogs($scope.currentADPage,$scope.adNoOfPage,$scope.adfilter.start,$scope.adfilter.end)},$scope.filter={},$scope.startDate={opened:!1},$scope.endDate={opened:!1},$scope.openStart=function(){$scope.startDate.opened=!0},$scope.openEnd=function(){$scope.endDate.opened=!0},$scope.filter.start=new Date,$scope.todayDate=new Date,$scope.currentPage=1,$scope.appHearders=["Sr. No","Error Class Name","Error Message","Error Trace","Params","Target URL","Time Stamp"],$scope.appNoOfPage="10",$scope.filterBtnActive=!1,$scope.companies=function(){$http.get("/admin/opustime_logs/company_list").success(function(result){$scope.allComps=result,$scope.appBusiness=""+result[0].id,$scope.qbBusiness=""+result[0].id,$scope.auBusiness=""+result[0].id,$scope.users(result[0].id)})},$scope.companies();var doRun=0;$scope.users=function(id){$scope.loading=!0,$http.get("/admin/opustime_logs/company_user_list?company_id="+id).success(function(result){$scope.allUsers=result,$scope.loading=!1,0==doRun&&($scope.allLogs($scope.currentPage,$scope.appNoOfPage,$scope.appBusiness,$scope.appUsers,$scope.filter.start,$scope.filter.end),doRun=1)})},$scope.allLogs=function(pageno,perPage,comp,user,start,end){$scope.loading=!0;var data={company_id:comp,user_id:user,start_date:start,end_date:end,page_no:pageno,per_page:perPage};data.start_date=start.getFullYear()+"-"+addZero(start.getMonth()+1)+"-"+start.getDate(),data.end_date&&(data.end_date=end.getFullYear()+"-"+addZero(end.getMonth()+1)+"-"+end.getDate()),$scope.filterBtnActive&&(data.isFilter=!0,$scope.filterBtnActive=!1),$http.post("/admin/opustime_logs/company_logs",data).success(function(result){if($scope.loading=!1,result.flag){$scope.appLogsDetail=result,$scope.currentPage>1?$scope.sr=($scope.currentPage-1)*parseInt(perPage)+1:$scope.sr=1,$scope.appLogsDetail.data.forEach(function(list){list.srNo=$scope.sr,$scope.sr+=1}),$scope.total_showing=$scope.appLogsDetail.data.length,$scope.paginationItems=[],$scope.drinks=[];var totalPages=$scope.appLogsDetail.total_page;for(i=1;i<=totalPages;i++)$scope.paginationItems.push({pageno:i})}})},$scope.updateCompany=function(comp_id){$scope.appUsers=void 0,$scope.users(comp_id)},$scope.filterLog=function(perPage,user){$scope.filterBtnActive=!0,$scope.allLogs($scope.currentPage,perPage,$scope.appBusiness,user,$scope.filter.start,$scope.filter.end)},$scope.updatePerPage=function(perPage,user){$scope.allLogs($scope.currentPage,perPage,$scope.appBusiness,user,$scope.filter.start,$scope.filter.end)},$scope.updatePage=function(no,perPage,user){$scope.currentPage=parseInt(no),$scope.allLogs($scope.currentPage,perPage,$scope.appBusiness,user,$scope.filter.start,$scope.filter.end)},$scope.openView=function(data){$scope.modalInstance=$uibModal.open({templateUrl:"appLog.html",controller:"appLogCtrl",size:"lg",resolve:{data:function(){return data}}})},$scope.qbfilter={},$scope.startDateQB={opened:!1},$scope.endDateQB={opened:!1},$scope.openQBStart=function(){$scope.startDateQB.opened=!0},$scope.openQBEnd=function(){$scope.endDateQB.opened=!0},$scope.qbfilter.start=new Date,$scope.currentQBPage=1,$scope.qbHearders=["Sr. No","Model Id","Model Name","Action Name","Message","Status","Time Stamp"],$scope.qbNoOfPage="10",$scope.filterQBBtnActive=!1,$scope.allQbLogs=function(pageno,perPage,comp,start,end){$scope.loading=!0;var data={company_id:comp,start_date:start,end_date:end,page_no:pageno,per_page:perPage};data.start_date=start.getFullYear()+"-"+addZero(start.getMonth()+1)+"-"+start.getDate(),data.end_date&&(data.end_date=end.getFullYear()+"-"+addZero(end.getMonth()+1)+"-"+end.getDate()),$scope.filterQBBtnActive&&(data.isFilter=!0,$scope.filterQBBtnActive=!1),$http.post("/admin/opustime/quickbooks_logs",data).success(function(result){if($scope.loading=!1,result.flag){$scope.qbLogsDetail=result,$scope.currentQBPage>1?$scope.srQB=($scope.currentQBPage-1)*parseInt(perPage)+1:$scope.srQB=1,$scope.qbLogsDetail.data.forEach(function(list){list.srNo=$scope.srQB,$scope.srQB+=1}),$scope.total_showingQB=$scope.qbLogsDetail.data.length,$scope.qbPaginationItems=[];var totalPages=$scope.qbLogsDetail.total_page;for(i=1;i<=totalPages;i++)$scope.qbPaginationItems.push({pageno:i})}})},$scope.filterQBLog=function(perPage){$scope.filterQBBtnActive=!0,$scope.allQbLogs($scope.currentQBPage,perPage,$scope.qbBusiness,$scope.qbfilter.start,$scope.qbfilter.end)},$scope.updateQBPerPage=function(perPage){$scope.allQbLogs($scope.currentQBPage,perPage,$scope.qbBusiness,$scope.qbfilter.start,$scope.qbfilter.end)},$scope.updateQBPage=function(no,perPage){$scope.currentQBPage=parseInt(no),$scope.allQbLogs($scope.currentQBPage,perPage,$scope.qbBusiness,$scope.qbfilter.start,$scope.qbfilter.end)},$scope.openQBView=function(data){$scope.modalInstance=$uibModal.open({templateUrl:"qbLog.html",controller:"qbLogCtrl",size:"lg",resolve:{data:function(){return data}}})},$scope.aufilter={},$scope.startDateAU={opened:!1},$scope.endDateAU={opened:!1},$scope.openAUStart=function(){$scope.startDateAU.opened=!0},$scope.openAUEnd=function(){$scope.endDateAU.opened=!0},$scope.aufilter.start=new Date,$scope.currentAUPage=1,$scope.auHearders=["Sr. No","Transaction Id","Transaction Type","Action Name","Amount","Response Code","Response Message","Status","Time Stamp"],$scope.auNoOfPage="10",$scope.filterAUBtnActive=!1,$scope.allAULogs=function(pageno,perPage,comp,start,end){$scope.loading=!0;var data={company_id:comp,start_date:start,end_date:end,page_no:pageno,per_page:perPage};data.start_date=start.getFullYear()+"-"+addZero(start.getMonth()+1)+"-"+start.getDate(),data.end_date&&(data.end_date=end.getFullYear()+"-"+addZero(end.getMonth()+1)+"-"+end.getDate()),$scope.filterAUBtnActive&&(data.isFilter=!0,$scope.filterAUBtnActive=!1),$http.post("/admin/opustime/authorizenet_logs",data).success(function(result){if($scope.loading=!1,result.flag){$scope.auLogsDetail=result,$scope.currentAUPage>1?$scope.srAU=($scope.currentAUPage-1)*parseInt(perPage)+1:$scope.srAU=1,$scope.auLogsDetail.data.forEach(function(list){list.srNo=$scope.srAU,$scope.srAU+=1}),$scope.total_showingAU=$scope.auLogsDetail.data.length,$scope.auPaginationItems=[];var totalPages=$scope.auLogsDetail.total_page;for(i=1;i<=totalPages;i++)$scope.auPaginationItems.push({pageno:i})}})},$scope.filterAULog=function(perPage){$scope.filterAUBtnActive=!0,$scope.allAULogs($scope.currentAUPage,perPage,$scope.auBusiness,$scope.aufilter.start,$scope.aufilter.end)},$scope.updateAUPerPage=function(perPage){$scope.allAULogs($scope.currentAUPage,perPage,$scope.auBusiness,$scope.aufilter.start,$scope.aufilter.end)},$scope.updateAUPage=function(no,perPage){$scope.currentAUPage=parseInt(no),$scope.allAULogs($scope.currentAUPage,perPage,$scope.auBusiness,$scope.aufilter.start,$scope.aufilter.end)},$scope.openAUView=function(data){$scope.modalInstance=$uibModal.open({templateUrl:"auLog.html",controller:"auLogCtrl",size:"md",resolve:{data:function(){return data}}})},$scope.adfilter={},$scope.startDateAD={opened:!1},$scope.endDateAD={opened:!1},$scope.openADStart=function(){$scope.startDateAD.opened=!0},$scope.openADEnd=function(){$scope.endDateAD.opened=!0},$scope.adfilter.start=new Date,$scope.currentADPage=1,$scope.adHearders=["Sr. No","Error Class Name","Error Message","Error Trace","Params","Target URL","Time Stamp"],$scope.adNoOfPage="10",$scope.filterADBtnActive=!1,$scope.allADLogs=function(pageno,perPage,start,end){$scope.loading=!0;var data={start_date:start,end_date:end,page_no:pageno,per_page:perPage};data.start_date=start.getFullYear()+"-"+addZero(start.getMonth()+1)+"-"+start.getDate(),data.end_date&&(data.end_date=end.getFullYear()+"-"+addZero(end.getMonth()+1)+"-"+end.getDate()),$scope.filterADBtnActive&&(data.isFilter=!0,$scope.filterADBtnActive=!1),$http.post("/admin/opustime/admin_logs",data).success(function(result){if($scope.loading=!1,result.flag){$scope.adLogsDetail=result,$scope.currentADPage>1?$scope.srAD=($scope.currentADPage-1)*parseInt(perPage)+1:$scope.srAD=1,$scope.adLogsDetail.data.forEach(function(list){list.srNo=$scope.srAD,$scope.srAD+=1}),$scope.total_showingAD=$scope.adLogsDetail.data.length,$scope.adPaginationItems=[];var totalPages=$scope.adLogsDetail.total_page;for(i=1;i<=totalPages;i++)$scope.adPaginationItems.push({pageno:i})}})},$scope.filterADLog=function(perPage){$scope.filterADBtnActive=!0,$scope.allADLogs($scope.currentADPage,perPage,$scope.adfilter.start,$scope.adfilter.end)},$scope.updateADPerPage=function(perPage){$scope.allADLogs($scope.currentADPage,perPage,$scope.adfilter.start,$scope.adfilter.end)},$scope.updateADPage=function(no,perPage){$scope.currentADPage=parseInt(no),$scope.allADLogs($scope.currentADPage,perPage,$scope.adfilter.start,$scope.adfilter.end)},$scope.openADView=function(data){$scope.modalInstance=$uibModal.open({templateUrl:"adLog.html",controller:"adLogCtrl",size:"lg",resolve:{data:function(){return data}}})}}]),adminApp.controller("appLogCtrl",["$scope","data","$modalInstance",function($scope,data,$modalInstance){$scope.logData=data,$scope.close=function(){$modalInstance.dismiss("cancel")}}]),adminApp.controller("qbLogCtrl",["$scope","data","$modalInstance",function($scope,data,$modalInstance){$scope.qbLogData=data,$scope.close=function(){$modalInstance.dismiss("cancel")}}]),adminApp.controller("auLogCtrl",["$scope","data","$modalInstance",function($scope,data,$modalInstance){$scope.auLogData=data,$scope.close=function(){$modalInstance.dismiss("cancel")}}]),adminApp.controller("adLogCtrl",["$scope","data","$modalInstance",function($scope,data,$modalInstance){$scope.adLogData=data,$scope.close=function(){$modalInstance.dismiss("cancel")}}]);